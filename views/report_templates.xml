<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- SPACEY LAYOUT MAIN TEMPLATE -->
        <template id="external_layout_spacey">
            <!-- Header Section -->
            <div t-attf-class="header o_company_#{company.id}_layout" t-att-style="report_header_style">
                <div class="o_spacey_header">
                    <div class="row">
                        
                        <!-- LEFT COLUMN: Company Logo -->
                        <!-- Shows company logo if available, takes 1/4 of header width -->
                        <div class="col-3">
                            <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" alt="Logo"/>
                        </div>
                        
                        <!-- CENTER COLUMN: Document Title and Number -->
                        <!-- Shows document type (INVOICE/DELIVERY NOTE) and document number -->
                        <!-- Takes 1/2 of header width, centered both horizontally and vertically -->
                        <div class="col-6 text-center" style="display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 60px;">
                            <!-- DOCUMENT TYPE DETECTION -->
                            <!-- Automatically detects what type of document is being printed -->
                            <!-- and shows appropriate title with specific states for invoices -->
                            
                            <!-- Document Title - Enhanced QWeb Compatible Logic -->
                            <h2 style="margin: 3px 0; color: #2C5282; font-weight: bold; font-size: 18px; text-transform: uppercase; letter-spacing: 1px;">
                                <!-- Stock Picking -->
                                <t t-if="o._name == 'stock.picking'">Delivery Note</t>
                                
                                <!-- Account Move (Invoice) with States -->
                                <t t-if="o._name == 'account.move'">
                                    <t t-if="o.type == 'out_invoice' and o.state == 'posted'">Invoice</t>
                                    <t t-if="o.type == 'out_invoice' and o.state == 'draft'">Draft Invoice</t>
                                    <t t-if="o.type == 'out_invoice' and o.state == 'cancel'">Cancelled Invoice</t>
                                    <t t-if="o.type == 'out_refund'">Credit Note</t>
                                    <t t-if="o.type == 'in_refund'">Vendor Credit Note</t>
                                    <t t-if="o.type == 'in_invoice'">Vendor Bill</t>
                                    <t t-if="o.type not in ['out_invoice', 'out_refund', 'in_refund', 'in_invoice']">Invoice</t>
                                </t>
                                
                                <!-- Sale Order with States -->
                                <t t-if="o._name == 'sale.order'">
                                    <t t-if="o.state in ['draft', 'sent']">Quotation</t>
                                    <t t-if="o.state not in ['draft', 'sent']">Sales Order</t>
                                </t>
                                
                                <!-- Purchase Order with States -->
                                <t t-if="o._name == 'purchase.order'">
                                    <t t-if="o.state == 'draft'">Request for Quotation</t>
                                    <t t-if="o.state in ['sent', 'to approve']">Purchase Order</t>
                                    <t t-if="o.state in ['purchase', 'done']">Purchase Order</t>
                                    <t t-if="o.state == 'cancel'">Cancelled Purchase Order</t>
                                    <t t-if="o.state not in ['draft', 'sent', 'to approve', 'purchase', 'done', 'cancel']">Purchase Order</t>
                                </t>
                                
                                <!-- Default -->
                                <t t-if="o._name not in ['stock.picking', 'account.move', 'sale.order', 'purchase.order']">Document</t>
                            </h2>
                            <!-- Document Number -->
                            <p style="margin: 2px 0; font-weight: bold; font-size: 15px; color: #2C5282;" t-if="o.name">
                                <span t-field="o.name"/>
                            </p>
                        </div>
                        
                        <!-- RIGHT COLUMN: Company Information -->
                        <!-- Shows company details: name, tax ID, phone, email, website -->
                        <!-- Takes 1/4 of header width, right-aligned -->
                        <div class="col-3" name="company_address" style="text-align: right;">
                            <div style="font-size: 12px; line-height: 1.3;">
                                <!-- Company Name (bold and larger) -->
                                <div t-if="company.name" style="font-weight: bold; font-size: 15px; color: #2C5282; margin-bottom: 2px;">
                                    <span t-field="company.name"/>
                                </div>
                                <!-- Company Tax ID/VAT Number -->
                                <div t-if="company.vat" style="margin-bottom: 1px; color: #4A5568;">
                                    <span t-esc="company.country_id.vat_label or 'Tax ID'"/>: <span t-field="company.vat"/>
                                </div>
                                <!-- Company Phone Number -->
                                <div t-if="company.phone" style="margin-bottom: 1px; color: #4A5568;">
                                    Tel: <span class="o_force_ltr" t-field="company.phone"/>
                                </div>
                                <!-- Company Email -->
                                <div t-if="company.email" style="margin-bottom: 1px; color: #4A5568;">
                                    <span t-field="company.email"/>
                                </div>
                                <!-- Company Website -->
                                <div t-if="company.website" style="color: #4A5568;">
                                    <span t-field="company.website"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ===== DOCUMENT BODY/CONTENT AREA ===== -->
            <div t-attf-class="article o_report_layout_spacey o_company_#{company.id}_layout" t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id" t-att-data-oe-lang="o and o.env.context.get('lang')">
                <!-- Address Layout: Company address information (used by some document types) -->
                <t t-call="web.address_layout"/>
                
                <!-- Main Document Content: Invoice lines, totals, terms & conditions, etc. -->
                <!-- The '0' refers to the body content passed by the report system -->
                <!-- This is where all the actual document data appears -->
                <t t-raw="0"/>
            </div>

            <!-- ===== FOOTER SECTION ===== -->
            <!-- Clean footer with reduced thickness and page numbering -->
            <!-- Uses company-specific styling for consistent branding -->
            <!-- Only shows page numbers in PDF mode for better print formatting -->
            <div t-attf-class="footer o_spacey_footer o_company_#{company.id}_layout">
                <div class="row mt4">
                    <div class="col-8">
                        <div style="display: flex; flex-direction: column;">
                            <span t-field="company.report_footer" style="margin-bottom: 2px; font-size: 15px;"/>
                            <h4 class="mt0 mb0 text-uppercase" t-field="company.report_header" style="font-size: 11px;"/>
                        </div>
                    </div>
                    <div class="col-4 text-right">
                        <span t-if="report_type == 'pdf'" style="font-size: 15px;">
                            Page <span class="page"/> / <span class="topage"/>
                        </span>
                    </div>
                </div>
            </div>


        </template>

        
        
        
        <!-- ===== LAYOUT REGISTRATION ===== -->
        <!-- Register the Spacey Layout in Odoo's layout system -->
        <!-- This makes it available in Company Settings > Report Layout dropdown -->
        <!-- IMPORTANT: This record must be defined AFTER the template definitions above -->
        <record id="report_layout_spacey" model="report.layout">
            <!-- Display name in the layout selection dropdown -->
            <field name="name">Spacey Layout</field>
            
            <!-- Reference to our main template (external_layout_spacey) -->
            <!-- This tells Odoo which template to use when this layout is selected -->
            <field name="view_id" ref="external_layout_spacey"/>
            
            <!-- Preview image shown in Company Settings (optional) -->
            <!-- Should be a screenshot of the layout for easy identification -->
            <field name="image">/dh_efficient_layout/static/description/layout_spacey.png</field>
            
            <!-- Sample PDF for preview (optional) -->
            <!-- Shows users what the final output will look like -->
            <field name="pdf">/dh_efficient_layout/static/description/layout_spacey.pdf</field>
        </record>
        
    </data>
</odoo>